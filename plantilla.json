{

  "variables": {
    "oas-repo-name": "{{env `OAS_REPO`}}"
  },

  "builders": [
    {
      "type": "amazon-ebs",
      "ssh_pty": "true",
      "ami_name": "oas-condor-estudiantes {{timestamp}}",
      "instance_type": "t2.micro",
      "region": "us-east-1",
      "source_ami": "ami-6d1c2007",
      "ssh_username": "centos",
      "iam_instance_profile": "oas-ami-builder-role",
      "launch_block_device_mappings": [
        {
          "volume_type": "gp2",
          "device_name": "/dev/sda1",
          "delete_on_termination": true,
          "volume_size": 30
        }
      ]
    }
  ],

  "provisioners": [
    {
      "type": "shell",
      "script": "install_aws.sh"
    },
    {
      "type": "shell",
      "script": "instalar-condor-estudiantes.sh",
      "environment_vars": [
        "oas_repo={{user `oas-repo-name`}}"
      ]
    }
  ]
}

